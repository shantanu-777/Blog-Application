@page "/"
@inject IBlogService BlogService
@inject IAuthService AuthService
@inject NavigationManager Navigation

<PageTitle>BlogApp - The Future of Blogging</PageTitle>

<div class="hero-section">
    <MudContainer MaxWidth="MaxWidth.Large" Class="text-center py-16">
        <MudText Typo="Typo.h2" Class="mb-4" Style="font-weight: 700; color: #1a1a1a;">
            Welcome to BlogApp
        </MudText>
        <MudText Typo="Typo.h5" Class="mb-8" Style="color: #666;">
            The most advanced blogging platform with AI-powered content creation
        </MudText>
        <div class="mb-8">
            @if (isAuthenticated)
            {
                <MudButton Variant="Variant.Filled" Color="Color.Primary" Size="Size.Large" Href="/write" Class="mr-4">
                    <MudIcon Icon="Icons.Material.Filled.Edit" Class="mr-2" />
                    Write Post
                </MudButton>
                <MudButton Variant="Variant.Outlined" Color="Color.Primary" Size="Size.Large" Href="/ai-write">
                    <MudIcon Icon="Icons.Material.Filled.AutoAwesome" Class="mr-2" />
                    AI Write
                </MudButton>
            }
            else
            {
                <MudButton Variant="Variant.Filled" Color="Color.Primary" Size="Size.Large" Href="/register" Class="mr-4">
                    Get Started
                </MudButton>
                <MudButton Variant="Variant.Outlined" Color="Color.Primary" Size="Size.Large" Href="/login">
                    Sign In
                </MudButton>
            }
        </div>
    </MudContainer>
</div>

<div class="features-section">
    <MudContainer MaxWidth="MaxWidth.Large" Class="py-16">
        <MudText Typo="Typo.h3" Class="text-center mb-8" Style="font-weight: 600;">
            Why Choose BlogApp?
        </MudText>
        <MudGrid>
            <MudItem xs="12" md="4">
                <MudCard Class="pa-6 text-center" Style="height: 100%;">
                    <MudIcon Icon="Icons.Material.Filled.AutoAwesome" Size="Size.Large" Color="Color.Primary" Class="mb-4" />
                    <MudText Typo="Typo.h6" Class="mb-3">AI-Powered Writing</MudText>
                    <MudText Typo="Typo.body2" Style="color: #666;">
                        Generate high-quality content with our advanced AI technology
                    </MudText>
                </MudCard>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudCard Class="pa-6 text-center" Style="height: 100%;">
                    <MudIcon Icon="Icons.Material.Filled.People" Size="Size.Large" Color="Color.Secondary" Class="mb-4" />
                    <MudText Typo="Typo.h6" Class="mb-3">Collaboration</MudText>
                    <MudText Typo="Typo.body2" Style="color: #666;">
                        Work together with other writers in collaborative spaces
                    </MudText>
                </MudCard>
            </MudItem>
            <MudItem xs="12" md="4">
                <MudCard Class="pa-6 text-center" Style="height: 100%;">
                    <MudIcon Icon="Icons.Material.Filled.TrendingUp" Size="Size.Large" Color="Color.Tertiary" Class="mb-4" />
                    <MudText Typo="Typo.h6" Class="mb-3">Smart Analytics</MudText>
                    <MudText Typo="Typo.body2" Style="color: #666;">
                        Get insights into your content performance and reader engagement
                    </MudText>
                </MudCard>
            </MudItem>
        </MudGrid>
    </MudContainer>
</div>

<div class="posts-section">
    <MudContainer MaxWidth="MaxWidth.Large" Class="py-16">
        <div class="d-flex justify-space-between align-center mb-6">
            <MudText Typo="Typo.h4" Style="font-weight: 600;">Latest Posts</MudText>
            <MudButton Variant="Variant.Text" Color="Color.Primary" Href="/trending">
                View All
                <MudIcon Icon="Icons.Material.Filled.ArrowForward" Class="ml-1" />
            </MudButton>
        </div>

        @if (isLoading)
        {
            <MudGrid>
                @for (int i = 0; i < 3; i++)
                {
                    <MudItem xs="12" md="4">
                        <MudSkeleton Height="200px" Class="mb-4" />
                        <MudSkeleton Height="20px" Class="mb-2" />
                        <MudSkeleton Height="16px" Class="mb-2" />
                        <MudSkeleton Height="16px" Width="60%" />
                    </MudItem>
                }
            </MudGrid>
        }
        else
        {
            <MudGrid>
                @foreach (var post in posts.Take(6))
                {
                    <MudItem xs="12" md="4">
                        <MudCard Class="mb-4" Style="height: 100%; cursor: pointer;" @onclick="() => NavigateToPost(post.Slug)">
                            @if (!string.IsNullOrEmpty(post.FeaturedImageUrl))
                            {
                                <img src="@post.FeaturedImageUrl" alt="@post.Title" style="width: 100%; height: 200px; object-fit: cover;" />
                            }
                            <MudCardContent Class="pa-4">
                                <MudText Typo="Typo.h6" Class="mb-2" Style="font-weight: 600; line-height: 1.3;">
                                    @post.Title
                                </MudText>
                                <MudText Typo="Typo.body2" Class="mb-3" Style="color: #666; line-height: 1.4;">
                                    @post.Excerpt
                                </MudText>
                                <div class="d-flex justify-space-between align-center">
                                    <MudText Typo="Typo.caption" Style="color: #999;">
                                        @post.Author?.DisplayName • @post.CreatedAt.ToString("MMM dd")
                                    </MudText>
                                    <MudText Typo="Typo.caption" Style="color: #999;">
                                        @post.ReadingTimeMinutes min read
                                    </MudText>
                                </div>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                }
            </MudGrid>
        }
    </MudContainer>
</div>

@code {
    private List<BlogPost> posts = new();
    private bool isLoading = true;
    private bool isAuthenticated = false;

    protected override async Task OnInitializedAsync()
    {
        isAuthenticated = await AuthService.IsAuthenticatedAsync();
        await LoadPosts();
    }

    private async Task LoadPosts()
    {
        try
        {
            posts = await BlogService.GetPostsAsync(1, 6);
        }
        catch (Exception)
        {
            // Handle error
        }
        finally
        {
            isLoading = false;
        }
    }

    private void NavigateToPost(string slug)
    {
        // Navigation logic would go here
    }
}

<style>
    .hero-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .features-section {
        background-color: #f8f9fa;
    }

    .posts-section {
        background-color: white;
    }
</style>
