@page "/"
@inject IBlogService BlogService
@inject IAuthService AuthService
@inject NavigationManager Navigation

<PageTitle>BlogApp - The Future of Blogging</PageTitle>

<div class="medium-navbar">
    <div class="medium-navbar-content">
        <span class="medium-logo">BlogApp</span>
        <nav>
            <a href="/" class="medium-nav-link">Home</a>
            <a href="/trending" class="medium-nav-link">Trending</a>
            <a href="/search" class="medium-nav-link">Search</a>
            @if (isAuthenticated)
            {
                <a href="/write" class="medium-nav-link">Write</a>
                <a href="/ai-write" class="medium-nav-link">AI Write</a>
                <a href="/profile" class="medium-nav-link">Profile</a>
            }
            else
            {
                <a href="/login" class="medium-nav-link">Login</a>
                <a href="/register" class="medium-nav-link medium-nav-link-accent">Sign Up</a>
            }
        </nav>
    </div>
</div>

<div class="medium-hero">
    <h1>Welcome to BlogApp</h1>
    <p class="medium-hero-desc">The most advanced blogging platform with AI-powered content creation</p>
    <div class="medium-hero-actions">
        @if (isAuthenticated)
        {
            <a href="/write" class="medium-btn medium-btn-primary">Write Post</a>
            <a href="/ai-write" class="medium-btn medium-btn-outline">AI Write</a>
        }
        else
        {
            <a href="/register" class="medium-btn medium-btn-primary">Get Started</a>
            <a href="/login" class="medium-btn medium-btn-outline">Sign In</a>
        }
    </div>
</div>

<div class="medium-features">
    <h2>Why Choose BlogApp?</h2>
    <div class="medium-features-list">
        <div class="medium-feature">
            <h3>AI-Powered Writing</h3>
            <p>Generate high-quality content with our advanced AI technology</p>
        </div>
        <div class="medium-feature">
            <h3>Collaboration</h3>
            <p>Work together with other writers in collaborative spaces</p>
        </div>
        <div class="medium-feature">
            <h3>Smart Analytics</h3>
            <p>Get insights into your content performance and reader engagement</p>
        </div>
    </div>
</div>

<div class="medium-posts">
    <div class="medium-posts-header">
        <h2>Latest Posts</h2>
        <a href="/trending" class="medium-link">View All</a>
    </div>
    <div class="medium-posts-list">
        @if (isLoading)
        {
            <div class="medium-post-skeleton" />
            <div class="medium-post-skeleton" />
            <div class="medium-post-skeleton" />
        }
        else
        {
            @foreach (var post in posts.Take(6))
            {
                <div class="medium-post-card" @onclick="() => NavigateToPost(post.Slug)">
                    @if (!string.IsNullOrEmpty(post.FeaturedImageUrl))
                    {
                        <img src="@post.FeaturedImageUrl" alt="@post.Title" class="medium-post-img" />
                    }
                    <div class="medium-post-content">
                        <h3>@post.Title</h3>
                        <p class="medium-post-excerpt">@post.Excerpt</p>
                        <div class="medium-post-meta">
                            <span>@post.Author?.DisplayName • @post.CreatedAt.ToString("MMM dd")</span>
                            <span>@post.ReadingTimeMinutes min read</span>
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</div>

@code {
    private List<BlogPost> posts = new();
    private bool isLoading = true;
    private bool isAuthenticated = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            isAuthenticated = await AuthService.IsAuthenticatedAsync();
            await LoadPosts();
            StateHasChanged();
        }
    }

    private async Task LoadPosts()
    {
        try
        {
            posts = await BlogService.GetPostsAsync(1, 6);
        }
        catch (Exception)
        {
            // Handle error
        }
        finally
        {
            isLoading = false;
        }
    }

    private void NavigateToPost(string slug)
    {
        if (!string.IsNullOrEmpty(slug))
        {
            Navigation.NavigateTo($"/post/{slug}");
        }
    }
}

<style>
body {
    font-family: 'Inter', 'Georgia', 'system-ui', Arial, sans-serif;
    background: #fafafa;
    color: #222;
    margin: 0;
}
.medium-navbar {
    background: #fff;
    border-bottom: 1px solid #eee;
    padding: 0.5rem 0;
    position: sticky;
    top: 0;
    z-index: 100;
}
.medium-navbar-content {
    max-width: 900px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.medium-logo {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -1px;
}
.medium-nav-link {
    color: #222;
    text-decoration: none;
    margin: 0 0.75rem;
    font-size: 1rem;
    font-weight: 500;
    transition: color 0.2s;
}
.medium-nav-link:hover {
    color: #1a8917;
}
.medium-nav-link-accent {
    color: #fff;
    background: #1a8917;
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    margin-left: 0.5rem;
}
.medium-hero {
    background: linear-gradient(90deg, #a8edea 0%, #fed6e3 100%);
    padding: 3rem 0 2rem 0;
    text-align: center;
}
.medium-hero h1 {
    font-size: 2.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}
.medium-hero-desc {
    font-size: 1.25rem;
    color: #444;
    margin-bottom: 1.5rem;
}
.medium-hero-actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
}
.medium-btn {
    font-size: 1rem;
    font-weight: 600;
    padding: 0.7rem 2rem;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.2s, color 0.2s;
}
.medium-btn-primary {
    background: #1a8917;
    color: #fff;
}
.medium-btn-primary:hover {
    background: #166d13;
}
.medium-btn-outline {
    background: #fff;
    color: #1a8917;
    border: 2px solid #1a8917;
}
.medium-btn-outline:hover {
    background: #f3f3f3;
}
.medium-features {
    background: #fff;
    padding: 2.5rem 0;
    max-width: 900px;
    margin: 2rem auto;
    border-radius: 16px;
    box-shadow: 0 2px 16px rgba(0,0,0,0.03);
}
.medium-features h2 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
}
.medium-features-list {
    display: flex;
    gap: 2rem;
    justify-content: center;
}
.medium-feature {
    flex: 1;
    background: #fafafa;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 1px 8px rgba(0,0,0,0.04);
    text-align: left;
}
.medium-feature h3 {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}
.medium-feature p {
    color: #444;
    font-size: 1rem;
}
.medium-posts {
    max-width: 900px;
    margin: 2rem auto 3rem auto;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 16px rgba(0,0,0,0.03);
    padding: 2rem 0 2rem 0;
}
.medium-posts-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
    padding: 0 2rem;
}
.medium-posts-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
}
.medium-link {
    color: #1a8917;
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
}
.medium-link:hover {
    text-decoration: underline;
}
.medium-posts-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 2rem;
    padding: 0 2rem;
}
.medium-post-card {
    background: #fafafa;
    border-radius: 12px;
    box-shadow: 0 1px 8px rgba(0,0,0,0.04);
    cursor: pointer;
    transition: box-shadow 0.2s;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}
.medium-post-card:hover {
    box-shadow: 0 4px 24px rgba(26,137,23,0.08);
}
.medium-post-img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-bottom: 1px solid #eee;
}
.medium-post-content {
    padding: 1.2rem;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}
.medium-post-content h3 {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}
.medium-post-excerpt {
    color: #444;
    font-size: 1rem;
    margin-bottom: 1rem;
}
.medium-post-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.95rem;
    color: #888;
}
.medium-post-skeleton {
    height: 260px;
    background: linear-gradient(90deg, #f3f3f3 25%, #eaeaea 50%, #f3f3f3 75%);
    border-radius: 12px;
    animation: skeleton-loading 1.2s infinite linear;
}
keyframes skeleton-loading {
    0% { background-position: -200px 0; }
    100% { background-position: 200px 0; }
}
</style>
